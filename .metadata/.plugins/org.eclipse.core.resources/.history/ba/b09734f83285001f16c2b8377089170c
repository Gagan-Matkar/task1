package com.example.Csv_extractor;


import static org.testng.Assert.assertFalse;
import static org.testng.Assert.assertNotNull;
import static org.testng.Assert.fail;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;
import java.sql.Statement;

import org.testng.*;
import org.testng.annotations.AfterClass;
import org.testng.annotations.BeforeClass;
import org.testng.annotations.Test;

public class AppTest{
	
	
	
	public static Connection testConnection;
	
	@BeforeClass
	public static void setUp() throws SQLException{
		
		String h2Url = "jdbc:h2:mem:testdb;DB_CLOSE_DELAY=-1";
		testConnection = DriverManager.getConnection(h2Url, "s", "");
		
		try (Statement stmt = testConnection.createStatement()) {
            String createTableSQL = "CREATE TABLE demo_acc (account_id VARCHAR(255) PRIMARY KEY, account_login VARCHAR(255), account_status VARCHAR(255), meta_type VARCHAR(255));";

            stmt.execute(createTableSQL);
        }
		App.setConnection(testConnection);
		
	}
	@AfterClass
	public static void exit() throws SQLException{
		if(testConnection != null && !testConnection.isClosed()) {
			testConnection.close();
		}
	}
	
	@Test
	public void testConnection() throws SQLException {
		assertNotNull(testConnection, "database connection should not be null");
		assertFalse(testConnection.isClosed(), "database connection should be open");
	}
	
	
	
	
	
	
}


